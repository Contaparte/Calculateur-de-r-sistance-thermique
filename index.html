<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculateur de Résistance Thermique</title>
  <!-- Bibliothèques React -->
  <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <!-- Tailwind CSS pour le style -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <!-- Chart.js pour les graphiques -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    // Fonction pour convertir RSI en R
    const rsiToR = (rsi) => {
      if (rsi === null || rsi === undefined || isNaN(rsi)) return null;
      return rsi * 5.678263;
    };
    
    // Fonction pour convertir R en RSI
    const rToRsi = (r) => {
      if (r === null || r === undefined || isNaN(r)) return null;
      return r / 5.678263;
    };
    
    // Fonction pour formater les valeurs RSI et R
    const formatRSIR = (rsi) => {
      if (rsi === null || rsi === undefined || isNaN(rsi)) return "-";
      const r = rsiToR(rsi);
      return `RSI ${rsi.toFixed(2)} (R ${r.toFixed(2)})`;
    };
    
    // Base de données des matériaux
    const materials = [
      // Films d'air
      { id: "exterior", name: "Pellicule d'air de surface (vent hivernal de 24 Km/h)", rsi: 0.03, r: 0.170, description: "Film d'air extérieur", category: "airfilm" },
      { id: "interior_wall", name: "Air stable, surface verticale, flux thermique horizontal", rsi: 0.12, r: 0.681, description: "Film d'air intérieur (mur)", category: "airfilm" },
      { id: "interior_ceiling", name: "Air stable, surface horizontale, flux thermique ascendant", rsi: 0.11, r: 0.625, description: "Film d'air intérieur (plafond)", category: "airfilm" },
      { id: "interior_floor", name: "Air stable, surface horizontale, flux thermique descendant", rsi: 0.16, r: 0.908, description: "Film d'air intérieur (plancher)", category: "airfilm" },
      
      // Lames d'air
      { id: "airspace_wall_13mm", name: "Lame d'air dans un mur - 13mm", rsi: 0.16, r: 0.908, description: "Flux thermique horizontal", category: "airspace" },
      { id: "airspace_wall_20mm", name: "Lame d'air dans un mur - 20mm", rsi: 0.18, r: 1.022, description: "Flux thermique horizontal", category: "airspace" },
      { id: "airspace_ceiling_13mm", name: "Lame d'air dans un plafond - 13mm", rsi: 0.15, r: 0.852, description: "Flux thermique ascendant", category: "airspace" },
      { id: "airspace_floor_13mm", name: "Lame d'air dans un plancher - 13mm", rsi: 0.16, r: 0.908, description: "Flux thermique descendant", category: "airspace" },
      
      // Matériaux de charpente
      { id: "wood_spf", name: "Bois de construction courant (s-p-f)", rsi: 0.0085, r: 1.226, description: "Par mm d'épaisseur", category: "structural" },
      { id: "wood_cedar", name: "Cèdre blanc", rsi: 0.0099, r: 1.428, description: "Par mm d'épaisseur", category: "structural" },
      { id: "concrete_2400", name: "Béton 2400 kg/m³", rsi: 0.0004, r: 0.058, description: "Par mm d'épaisseur", category: "structural" },
      
      // Isolants
      { id: "mineral_wool", name: "Laine de roche (Roxul Cavity Rock)", rsi: 0.0276, r: 4.000, description: "Par mm d'épaisseur", category: "insulation" },
      { id: "fiberglass", name: "Laine de fibre de verre, usage thermique", rsi: 0.0208, r: 3.170, description: "Par mm d'épaisseur", category: "insulation" },
      { id: "cellulose", name: "Fibre cellulosique", rsi: 0.024, r: 3.800, description: "Par mm d'épaisseur", category: "insulation" },
      { id: "eps_type1", name: "Polystyrène expansé Type 1", rsi: 0.0257, r: 3.706, description: "Par mm d'épaisseur", category: "insulation" },
      { id: "eps_type2", name: "Polystyrène expansé Type 2", rsi: 0.0277, r: 3.995, description: "Par mm d'épaisseur", category: "insulation" },
      { id: "xps", name: "Polystyrène extrudé", rsi: 0.0343, r: 5.000, description: "Par mm d'épaisseur", category: "insulation" },
      { id: "spray_foam", name: "Polyuréthane giclé", rsi: 0.0455, r: 6.600, description: "Par mm d'épaisseur", category: "insulation" },
      
      // Revêtements
      { id: "gypsum", name: "Plaque de plâtre (panneaux de gypse)", rsi: 0.0063, r: 0.909, description: "Par mm d'épaisseur", category: "sheathing" },
      { id: "plywood", name: "Contreplaqué de bois tendre", rsi: 0.0087, r: 1.255, description: "Par mm d'épaisseur", category: "sheathing" },
      { id: "osb", name: "Panneaux de copeaux (OSB)", rsi: 0.0098, r: 1.413, description: "Par mm d'épaisseur", category: "sheathing" },
      { id: "fiberboard", name: "Panneau de fibre de bois", rsi: 0.0194, r: 2.798, description: "Par mm d'épaisseur", category: "sheathing" },
      
      // Revêtements extérieurs
      { id: "brick_90mm", name: "Brique d'argile ou schiste - 90mm", rsi: 0.07, r: 0.397, description: "4'' nominal, 2400 kg/m³", category: "cladding" },
      { id: "vinyl_siding", name: "Bardage en vinyle", rsi: 0.11, r: 0.625, description: "Planche à clin, sans endos", category: "cladding" },
      { id: "wood_siding", name: "Bardage en bois", rsi: 0.14, r: 0.795, description: "Bardage à mi-bois, 200mm, épaisseur 20mm", category: "cladding" },
      { id: "metal_siding", name: "Bardage métallique", rsi: 0.11, r: 0.625, description: "Planche à clin, sans endos isolé", category: "cladding" },
    ];

    // Fonction pour obtenir les épaisseurs standard
    const getStandardThicknesses = (materialType) => {
      switch (materialType) {
        case 'airfilm':
          return [1]; // Épaisseur fixe pour les films d'air
        case 'airspace':
          return [13, 20, 40, 90]; // Épaisseurs standard en mm
        case 'insulation':
          return [25, 38, 76, 89, 140, 152, 178, 203, 254]; // Épaisseurs standard en mm
        case 'sheathing':
          return [6, 8, 11, 12.5, 16, 19]; // Épaisseurs standard en mm
        case 'cladding':
          return [90]; // Épaisseurs standard en mm pour la brique
        case 'structural':
          return [38, 89, 140, 184, 235, 286]; // Épaisseurs standard en mm pour le bois
        default:
          return [10, 20, 30, 40, 50]; // Épaisseurs par défaut
      }
    };

    // Fonction pour calculer la résistance thermique totale
    const calculateTotalRSI = (layers) => {
      return layers.reduce((total, layer) => {
        if (!layer.material) return total;
        let layerRSI = 0;
        
        if (layer.type === 'airfilm' || layer.type === 'airspace') {
          // Les films d'air et lames d'air ont une valeur RSI fixe
          layerRSI = layer.material.rsi;
        } else {
          // Les autres matériaux ont une valeur RSI par mm d'épaisseur
          layerRSI = layer.material.rsi * layer.thickness;
        }
        
        return total + layerRSI;
      }, 0);
    };

    // Fonction pour calculer la résistance thermique effective
    const calculateEffectiveRSI = (totalRSI) => {
      // Une estimation simplifiée - dans la réalité, le calcul serait plus complexe
      // Par exemple, pour des montants à 400mm c/c, on suppose que
      // les montants ont environ 10% de la résistance thermique totale
      return totalRSI * 0.85;
    };

    // Fonction pour calculer le point de rosée
    const calculateDewPoint = (temperature, humidity) => {
      // Formule pour le point de rosée
      const a = 17.27;
      const b = 237.7;
      const alpha = ((a * temperature) / (b + temperature)) + Math.log(humidity / 100.0);
      return (b * alpha) / (a - alpha);
    };

    // Fonction pour calculer les gradients de température
    const calculateTemperatureGradients = (layers, interiorTemp, exteriorTemp) => {
      const totalRSI = calculateTotalRSI(layers);
      const deltaT = interiorTemp - exteriorTemp;
      
      let cumulativeRSI = 0;
      const gradients = [];
      
      // Ajouter la température intérieure comme point de départ
      gradients.push({
        position: 0,
        temperature: interiorTemp
      });
      
      // Calculer la température à chaque interface
      layers.forEach(layer => {
        if (!layer.material) return;
        
        let layerRSI = 0;
        if (layer.type === 'airfilm' || layer.type === 'airspace') {
          layerRSI = layer.material.rsi;
        } else {
          layerRSI = layer.material.rsi * layer.thickness;
        }
        
        cumulativeRSI += layerRSI;
        
        const proportion = cumulativeRSI / totalRSI;
        const temperature = interiorTemp - (proportion * deltaT);
        
        gradients.push({
          position: cumulativeRSI,
          temperature
        });
      });
      
      return gradients;
    };

    // Fonction pour vérifier la conformité au code
    const checkCompliance = (rsi, component, zone) => {
      // Valeurs minimales selon la partie 11 du Code
      const minimumRSI = {
        less_than_6000: {
          wall_above_grade: 4.31,
          foundation_wall: 2.99,
          floor: 5.20,
          roof: 7.22,
          garage_ceiling: 5.2,
          garage_wall: 3.5
        },
        at_least_6000: {
          wall_above_grade: 5.11,
          foundation_wall: 2.99,
          floor: 5.20,
          roof: 9.00,
          garage_ceiling: 5.2,
          garage_wall: 3.5
        }
      };
      
      return rsi >= minimumRSI[zone][component];
    };

    // Composant pour une couche individuelle
    const LayerItem = ({ layer, onUpdate, onRemove }) => {
      const filteredMaterials = materials.filter(m => m.category === layer.type);
      const needsThickness = layer.type !== 'airfilm' && layer.type !== 'airspace' && layer.type !== 'cladding';
      const standardThicknesses = (layer.material && needsThickness) ? 
                              getStandardThicknesses(layer.material.category) : [];
      
      return (
        <div className="border p-2 mb-2 flex items-center">
          <div className="flex-grow">
            <select 
              value={layer.material ? layer.material.id : ''} 
              onChange={(e) => {
                const selectedMaterial = materials.find(m => m.id === e.target.value);
                onUpdate('material', selectedMaterial);
                
                if (layer.type === 'airfilm' || layer.type === 'airspace' || layer.type === 'cladding') {
                  onUpdate('thickness', 1);
                } else if (selectedMaterial) {
                  const thicknesses = getStandardThicknesses(layer.type);
                  if (thicknesses.length > 0) {
                    onUpdate('thickness', thicknesses[0]);
                  }
                }
              }}
              className="w-full p-2 border rounded"
            >
              <option value="">Sélectionner un matériau</option>
              {filteredMaterials.map(material => (
                <option key={material.id} value={material.id}>
                  {material.name} ({material.description})
                </option>
              ))}
            </select>
          </div>
          
          {needsThickness && (
            <div className="ml-2">
              <select 
                value={layer.thickness || ''} 
                onChange={(e) => onUpdate('thickness', parseFloat(e.target.value))}
                disabled={!layer.material}
                className="w-full p-2 border rounded"
              >
                <option value="">Épaisseur</option>
                {standardThicknesses.map(thickness => (
                  <option key={thickness} value={thickness}>
                    {thickness} mm
                  </option>
                ))}
              </select>
            </div>
          )}
          
          <button 
            onClick={onRemove} 
            className="ml-2 bg-red-500 text-white p-2 rounded"
          >
            X
          </button>
        </div>
      );
    };

    // Composant principal
    const Calculator = () => {
      const [layers, setLayers] = React.useState([]);
      const [interiorTemp, setInteriorTemp] = React.useState(21);
      const [exteriorTemp, setExteriorTemp] = React.useState(-26);
      const [interiorHumidity, setInteriorHumidity] = React.useState(50);
      const [envelopeComponent, setEnvelopeComponent] = React.useState('wall_above_grade');
      const [climaticZone, setClimaticZone] = React.useState('less_than_6000');
      const [results, setResults] = React.useState(null);
      const chartRef = React.useRef(null);
      
      React.useEffect(() => {
        if (!results || !results.temperatureGradients) return;
        
        const ctx = document.getElementById('temperatureChart').getContext('2d');
        
        if (chartRef.current) {
          chartRef.current.destroy();
        }
        
        // Créer trois scénarios de température
        const temperatureScenarios = [
          {
            label: `Ext: ${exteriorTemp}°C`,
            data: results.temperatureGradients,
            borderColor: 'rgba(75, 192, 192, 1)'
          },
          {
            label: 'Ext: -10°C',
            data: calculateTemperatureGradients(layers, interiorTemp, -10),
            borderColor: 'rgba(255, 99, 132, 1)'
          },
          {
            label: 'Ext: 0°C',
            data: calculateTemperatureGradients(layers, interiorTemp, 0),
            borderColor: 'rgba(255, 205, 86, 1)'
          }
        ];
        
        const positions = temperatureScenarios[0].data.map(gradient => gradient.position.toFixed(2));
        
        const datasets = temperatureScenarios.map(scenario => ({
          label: scenario.label,
          data: scenario.data.map(gradient => gradient.temperature.toFixed(1)),
          borderColor: scenario.borderColor,
          tension: 0.1
        }));
        
        // Ajout de la ligne pour le point de rosée
        datasets.push({
          label: 'Point de rosée',
          data: Array(positions.length).fill(results.dewPoint.toFixed(1)),
          borderColor: 'rgba(255, 0, 0, 1)',
          borderDash: [5, 5],
          tension: 0
        });
        
        chartRef.current = new Chart(ctx, {
          type: 'line',
          data: {
            labels: positions,
            datasets
          },
          options: {
            responsive: true,
            plugins: {
              title: {
                display: true,
                text: 'Gradient de température à travers l\'enveloppe'
              }
            },
            scales: {
              y: {
                title: {
                  display: true,
                  text: 'Température (°C)'
                }
              },
              x: {
                title: {
                  display: true,
                  text: 'Position dans l\'enveloppe (RSI cumulatif)'
                }
              }
            }
          }
        });
      }, [results]);
      
      // Ajout d'une couche
      const addLayer = (type) => {
        const newLayer = {
          id: Date.now(),
          type,
          material: null,
          thickness: 0
        };
        setLayers([...layers, newLayer]);
      };
      
      // Suppression d'une couche
      const removeLayer = (id) => {
        setLayers(layers.filter(layer => layer.id !== id));
      };
      
      // Mise à jour d'une couche
      const updateLayer = (id, field, value) => {
        setLayers(layers.map(layer => 
          layer.id === id ? { ...layer, [field]: value } : layer
        ));
      };
      
      // Déplacer une couche vers le haut
      const moveLayerUp = (id) => {
        const index = layers.findIndex(layer => layer.id === id);
        if (index > 0) {
          const newLayers = [...layers];
          [newLayers[index - 1], newLayers[index]] = [newLayers[index], newLayers[index - 1]];
          setLayers(newLayers);
        }
      };
      
      // Déplacer une couche vers le bas
      const moveLayerDown = (id) => {
        const index = layers.findIndex(layer => layer.id === id);
        if (index < layers.length - 1) {
          const newLayers = [...layers];
          [newLayers[index], newLayers[index + 1]] = [newLayers[index + 1], newLayers[index]];
          setLayers(newLayers);
        }
      };
      
      // Calcul des résultats
      const calculate = () => {
        // Vérifier si tous les matériaux sont sélectionnés et ont une épaisseur
        const invalidLayers = layers.filter(layer => 
          !layer.material || 
          (layer.type !== 'airfilm' && layer.type !== 'airspace' && layer.type !== 'cladding' && !layer.thickness)
        );
        
        if (invalidLayers.length > 0) {
          alert("Veuillez sélectionner un matériau et une épaisseur pour toutes les couches.");
          return;
        }
        
        // Calcul de la résistance thermique totale
        const totalRSI = calculateTotalRSI(layers);
        const totalR = rsiToR(totalRSI);
        
        // Calcul de la résistance thermique effective
        const effectiveRSI = calculateEffectiveRSI(totalRSI);
        const effectiveR = rsiToR(effectiveRSI);
        
        // Calcul du point de rosée
        const dewPoint = calculateDewPoint(interiorTemp, interiorHumidity);
        
        // Vérification de la conformité au code
        const isCompliant = checkCompliance(effectiveRSI, envelopeComponent, climaticZone);
        
        // Calcul des gradients de température
        const temperatureGradients = calculateTemperatureGradients(layers, interiorTemp, exteriorTemp);
        
        // Vérification de la condensation
        let condensationRisk = false;
        let condensationLayer = null;
        
        for (let i = 0; i < temperatureGradients.length; i++) {
          if (temperatureGradients[i].temperature <= dewPoint) {
            condensationRisk = true;
            condensationLayer = i > 0 ? layers[i-1] : null;
            break;
          }
        }
        
        setResults({
          totalRSI,
          totalR,
          effectiveRSI,
          effectiveR,
          dewPoint,
          isCompliant,
          temperatureGradients,
          condensationRisk,
          condensationLayer
        });
      };
      
      return (
        <div className="container mx-auto p-4">
          <h1 className="text-2xl font-bold mb-4">Calculateur de Résistance Thermique</h1>
          
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
            <div>
              <label className="block mb-2">Composante de l'enveloppe</label>
              <select 
                value={envelopeComponent} 
                onChange={(e) => setEnvelopeComponent(e.target.value)}
                className="w-full p-2 border rounded"
              >
                <option value="wall_above_grade">Mur hors sol</option>
                <option value="foundation_wall">Mur de fondation</option>
                <option value="floor">Plancher séparant un espace chauffé</option>
                <option value="roof">Toit ou plafond</option>
                <option value="garage_ceiling">Plafond de garage chauffé</option>
                <option value="garage_wall">Murs de garage chauffé</option>
              </select>
            </div>
            
            <div>
              <label className="block mb-2">Zone climatique</label>
              <select 
                value={climaticZone}
                onChange={(e) => setClimaticZone(e.target.value)}
                className="w-full p-2 border rounded"
              >
                <option value="less_than_6000">Moins de 6000 degrés-jours</option>
                <option value="at_least_6000">6000 degrés-jours ou plus</option>
              </select>
            </div>
            
            <div>
              <label className="block mb-2">Type de bâtiment</label>
              <select className="w-full p-2 border rounded">
                <option value="residential">Bâtiment résidentiel</option>
                <option value="commercial">Bâtiment commercial</option>
              </select>
            </div>
          </div>
          
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
            <div>
              <label className="block mb-2">Température intérieure (°C)</label>
              <input 
                type="number" 
                value={interiorTemp} 
                onChange={(e) => setInteriorTemp(parseFloat(e.target.value))}
                className="w-full p-2 border rounded"
              />
            </div>
            
            <div>
              <label className="block mb-2">Température extérieure (°C)</label>
              <input 
                type="number" 
                value={exteriorTemp} 
                onChange={(e) => setExteriorTemp(parseFloat(e.target.value))}
                className="w-full p-2 border rounded"
              />
            </div>
            
            <div>
              <label className="block mb-2">Humidité relative intérieure (%)</label>
              <input 
                type="number" 
                value={interiorHumidity} 
                onChange={(e) => setInteriorHumidity(parseFloat(e.target.value))}
                className="w-full p-2 border rounded"
              />
            </div>
          </div>
          
          <div className="mb-4">
            <h2 className="text-xl font-bold mb-2">Composition de l'enveloppe</h2>
            <p className="mb-2">Ajoutez des couches de matériaux pour commencer l'analyse</p>
            
            <div className="space-y-2">
              {layers.map((layer, index) => (
                <div key={layer.id} className="flex items-center">
                  <div className="flex-grow">
                    <LayerItem 
                      layer={layer} 
                      onUpdate={(field, value) => updateLayer(layer.id, field, value)} 
                      onRemove={() => removeLayer(layer.id)}
                    />
                  </div>
                  <div className="flex ml-2">
                    <button 
                      onClick={() => moveLayerUp(layer.id)} 
                      disabled={index === 0}
                      className="bg-blue-500 text-white p-2 rounded"
                    >
                      ↑
                    </button>
                    <button 
                      onClick={() => moveLayerDown(layer.id)} 
                      disabled={index === layers.length - 1}
                      className="bg-blue-500 text-white p-2 rounded ml-1"
                    >
                      ↓
                    </button>
                  </div>
                </div>
              ))}
            </div>
            
            <div className="flex flex-wrap gap-2 mt-4">
              <button onClick={() => addLayer('airfilm')} className="bg-blue-500 text-white p-2 rounded">
                + Film d'air
              </button>
              <button onClick={() => addLayer('insulation')} className="bg-blue-500 text-white p-2 rounded">
                + Isolant
              </button>
              <button onClick={() => addLayer('sheathing')} className="bg-blue-500 text-white p-2 rounded">
                + Revêtement intermédiaire
              </button>
              <button onClick={() => addLayer('airspace')} className="bg-blue-500 text-white p-2 rounded">
                + Lame d'air
              </button>
              <button onClick={() => addLayer('cladding')} className="bg-blue-500 text-white p-2 rounded">
                + Parement extérieur
              </button>
              <button onClick={() => addLayer('structural')} className="bg-blue-500 text-white p-2 rounded">
                + Élément structural
              </button>
            </div>
          </div>
          
          <div className="mb-4">
            <button 
              onClick={calculate} 
              className="bg-green-500 text-white p-3 font-bold rounded"
            >
              Calculer la performance thermique
            </button>
          </div>
          
          {results && (
            <div className="mt-6 border rounded p-6 bg-gray-50">
              <h2 className="text-xl font-bold mb-4">Résultats d'analyse</h2>
              
              <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                <div>
                  <h3 className="text-lg font-bold">Résistance thermique totale</h3>
                  <p>RSI: <strong>{results.totalRSI.toFixed(2)}</strong></p>
                  <p>R: <strong>{results.totalR.toFixed(2)}</strong></p>
                </div>
                
                <div>
                  <h3 className="text-lg font-bold">Résistance thermique effective</h3>
                  <p>RSI: <strong>{results.effectiveRSI.toFixed(2)}</strong></p>
                  <p>R: <strong>{results.effectiveR.toFixed(2)}</strong></p>
                </div>
                
                <div>
                  <h3 className="text-lg font-bold">Point de rosée</h3>
                  <p><strong>{results.dewPoint.toFixed(1)}°C</strong></p>
                </div>
                
                <div>
                  <h3 className="text-lg font-bold">Conformité au Code</h3>
                  <p>
                    {results.isCompliant ? (
                      <span className="text-green-600">Conforme ✓</span>
                    ) : (
                      <span className="text-red-600">
                        Non conforme ✗
                      </span>
                    )}
                  </p>
                </div>
              </div>
              
              {results.condensationRisk && (
                <div className="mb-4 p-4 bg-yellow-100 border-yellow-400 border rounded">
                  <h3 className="text-lg font-bold text-yellow-800">Risque de condensation!</h3>
                  <p>Il y a un risque de condensation {results.condensationLayer ? 
                     `dans la couche ${results.condensationLayer.material?.description || 'inconnue'}` : 
                     'dans l\'assemblage'}.
                  </p>
                  <p>Pour éviter ce problème, envisagez d'augmenter l'isolation intérieure, 
                     de ventiler pour réduire l'humidité intérieure, etc.
                  </p>
                </div>
              )}
              
              <div className="mb-4">
                <h3 className="text-lg font-bold mb-2">Gradient de température à travers l'enveloppe</h3>
                <div className="border p-2 bg-white overflow-auto" style={{height: "400px"}}>
                  <canvas id="temperatureChart"></canvas>
                </div>
              </div>
              
              <table className="w-full border-collapse">
                <thead>
                  <tr className="bg-gray-200">
                    <th className="border p-2 text-left">Couche</th>
                    <th className="border p-2 text-left">Matériau</th>
                    <th className="border p-2 text-left">Épaisseur (mm)</th>
                    <th className="border p-2 text-left">RSI</th>
                    <th className="border p-2 text-left">R</th>
                  </tr>
                </thead>
                <tbody>
                  {layers.map((layer) => (
                    <tr key={layer.id}>
                      <td className="border p-2">{layer.type}</td>
                      <td className="border p-2">{layer.material?.name || "-"}</td>
                      <td className="border p-2">{layer.thickness || "-"}</td>
                      <td className="border p-2">
                        {layer.material ? 
                          (layer.type === 'airfilm' || layer.type === 'airspace' || layer.type === 'cladding' ? 
                            layer.material.rsi.toFixed(3) : 
                            (layer.material.rsi * layer.thickness).toFixed(3)) : 
                          "-"}
                      </td>
                      <td className="border p-2">
                        {layer.material ? 
                          (layer.type === 'airfilm' || layer.type === 'airspace' || layer.type === 'cladding' ? 
                            layer.material.r.toFixed(3) : 
                            rsiToR(layer.material.rsi * layer.thickness).toFixed(3)) : 
                          "-"}
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}
        </div>
      );
    };

    // Rendu du composant principal
    ReactDOM.render(<Calculator />, document.getElementById('root'));
  </script>
</body>
</html>
